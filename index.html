<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#ff4d8d" />
  <title>Be My Valentine üíñ</title>
  <style>
    :root{
      --bg1:#ff5aa5;
      --bg2:#ff3b6a;
      --bg3:#ffd1e3;
      --card:#ffffffee;
      --text:#2a0f1c;
      --muted:#5a2a3c;
      --yes1:#ff2f7a;
      --yes2:#ff6aa8;
      --no1:#d9d9e3;
      --no2:#f0f0f6;
      --shadow: 0 18px 50px rgba(0,0,0,.18);
      --radius: 22px;
      --btnH: 56px;
      --focus: 0 0 0 4px rgba(255, 47, 122, .25);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      overflow:hidden;
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,.35), transparent 50%),
        radial-gradient(900px 500px at 80% 20%, rgba(255,255,255,.22), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2) 55%, var(--bg3));
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    /* Floating hearts background */
    .bg-hearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:0;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.08));
    }
    .bg-hearts .h{
      position:absolute;
      width:18px;
      height:18px;
      background: rgba(255,255,255,.35);
      transform: rotate(45deg);
      border-radius: 4px;
      opacity:.75;
      animation: floatUp linear infinite;
      will-change: transform, top, left, opacity;
    }
    .bg-hearts .h::before,
    .bg-hearts .h::after{
      content:"";
      position:absolute;
      width:18px;
      height:18px;
      background: rgba(255,255,255,.35);
      border-radius: 50%;
    }
    .bg-hearts .h::before{ left:-9px; top:0; }
    .bg-hearts .h::after{ left:0; top:-9px; }

    @keyframes floatUp{
      0%   { transform: translate3d(0, 12vh, 0) rotate(45deg) scale(var(--s,1)); opacity:0; }
      10%  { opacity:.65; }
      100% { transform: translate3d(0, -120vh, 0) rotate(45deg) scale(var(--s,1)); opacity:0; }
    }

    /* App layout */
    .wrap{
      width:min(560px, 100%);
      z-index:1;
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:stretch;
    }

    .card{
      position:relative;
      background: var(--card);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border:1px solid rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 22px 18px 18px;
      overflow:hidden;
    }

    .card::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(240px 120px at 18% 10%, rgba(255,47,122,.18), transparent 55%),
        radial-gradient(260px 140px at 88% 18%, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(260px 180px at 50% 110%, rgba(255,59,106,.12), transparent 55%);
      pointer-events:none;
    }

    .content{
      position:relative;
      z-index:1;
      text-align:center;
      padding: 6px 8px 10px;
    }

    h1{
      margin: 6px 0 10px;
      font-size: clamp(28px, 5.6vw, 40px);
      line-height:1.12;
      letter-spacing:-0.3px;
      text-shadow: 0 1px 0 rgba(255,255,255,.4);
    }

    .sub{
      margin: 0 auto 16px;
      max-width: 34ch;
      color: var(--muted);
      font-size: 1.05rem;
      line-height:1.35;
    }

    .buttons{
      position:relative;
      z-index:2;
      height: calc(var(--btnH) * 2 + 14px);
      display:block;
      margin: 8px 0 4px;
    }

    button{
      border:none;
      border-radius: 999px;
      height: var(--btnH);
      padding: 0 18px;
      font-weight: 800;
      font-size: 1.1rem;
      letter-spacing: .2px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 10px 24px rgba(0,0,0,.14);
      transition: transform .08s ease, box-shadow .12s ease, filter .12s ease;
      touch-action: manipulation;
    }
    button:active{ transform: translateY(1px) scale(.99); }
    button:focus-visible{ outline:none; box-shadow: var(--shadow), var(--focus); }

    #yesBtn{
      position:absolute;
      left:50%;
      top: 0;
      transform: translateX(-50%);
      width: min(92%, 360px);
      color:white;
      background: linear-gradient(135deg, var(--yes1), var(--yes2));
      text-shadow: 0 1px 0 rgba(0,0,0,.14);
    }
    #yesBtn:hover{ filter: brightness(1.03); }
    #yesBtn .shine{
      position:absolute;
      inset:0;
      border-radius:999px;
      overflow:hidden;
      pointer-events:none;
    }
    #yesBtn .shine::after{
      content:"";
      position:absolute;
      width:120px;
      height:120px;
      left:-140px;
      top:-30px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(255,255,255,0) 60%);
      transform: rotate(15deg);
      animation: shine 2.8s ease-in-out infinite;
      opacity:.8;
    }
    @keyframes shine{
      0%{ transform: translateX(0) rotate(15deg); opacity:.55; }
      45%{ opacity:.85; }
      100%{ transform: translateX(520px) rotate(15deg); opacity:.45; }
    }

    /* "No" button is a decoy */
    #noBtn{
      position:absolute;
      left:50%;
      top: calc(var(--btnH) + 14px);
      transform: translateX(-50%);
      width: min(92%, 360px);
      background: linear-gradient(135deg, var(--no2), var(--no1));
      color: #4a3a45;
      cursor: default;
      pointer-events:none; /* Not clickable */
      box-shadow: 0 10px 18px rgba(0,0,0,.10);
    }

    .hint{
      position:relative;
      z-index:1;
      margin: 12px auto 0;
      font-size: .95rem;
      color: rgba(58,18,34,.7);
    }

    footer{
      text-align:center;
      color: rgba(255,255,255,.92);
      font-weight: 650;
      text-shadow: 0 2px 10px rgba(0,0,0,.18);
      font-size: .98rem;
      padding-bottom: 4px;
    }

    /* Celebration overlay */
    .overlay{
      position:fixed;
      inset:0;
      background:
        radial-gradient(900px 600px at 50% 10%, rgba(255,255,255,.25), transparent 55%),
        linear-gradient(135deg, rgba(255,47,122,.96), rgba(255,106,168,.90), rgba(255,209,227,.94));
      display:none;
      align-items:center;
      justify-content:center;
      z-index:10;
      overflow:hidden;
    }
    .overlay.show{ display:flex; }

    .celebrate{
      text-align:center;
      padding: 24px 18px;
      width:min(680px, 100%);
    }
    .celebrate h2{
      margin:0 0 10px;
      color:white;
      font-size: clamp(34px, 7vw, 56px);
      line-height:1.05;
      text-shadow: 0 10px 30px rgba(0,0,0,.2);
    }
    .celebrate p{
      margin: 0 auto;
      max-width: 40ch;
      color: rgba(255,255,255,.95);
      font-size: 1.15rem;
      line-height:1.4;
      text-shadow: 0 8px 22px rgba(0,0,0,.16);
    }

    .overlay .mini{
      margin-top: 12px;
      font-size: 1rem;
      opacity:.95;
    }

    /* Confetti + burst pieces */
    .confetti, .burst{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .confetti i{
      position:absolute;
      width:10px;
      height:16px;
      border-radius: 3px;
      opacity:.95;
      transform: translate3d(0,-10vh,0) rotate(0deg);
      animation: fall linear forwards;
      will-change: transform, opacity;
    }
    @keyframes fall{
      0%   { transform: translate3d(var(--x,0), -12vh, 0) rotate(0deg); opacity:0; }
      10%  { opacity:1; }
      100% { transform: translate3d(calc(var(--x,0) + var(--drift, 0px)), 110vh, 0) rotate(var(--r, 720deg)); opacity:0.98; }
    }

    .burst .heart{
      position:absolute;
      width:14px;
      height:14px;
      background: rgba(255,255,255,.92);
      transform: rotate(45deg);
      border-radius: 3px;
      opacity:0;
      animation: pop 900ms ease-out forwards;
    }
    .burst .heart::before,
    .burst .heart::after{
      content:"";
      position:absolute;
      width:14px;
      height:14px;
      background: rgba(255,255,255,.92);
      border-radius: 50%;
    }
    .burst .heart::before{ left:-7px; top:0; }
    .burst .heart::after{ left:0; top:-7px; }

    @keyframes pop{
      0%   { transform: translate3d(0,0,0) rotate(45deg) scale(0.7); opacity:0; }
      15%  { opacity:1; }
      100% { transform: translate3d(var(--dx,0px), var(--dy,0px), 0) rotate(45deg) scale(1.15); opacity:0; }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .bg-hearts .h, #yesBtn .shine::after, .confetti i, .burst .heart { animation: none !important; }
      body{ overflow:auto; }
    }
  </style>
</head>
<body>
  <div class="bg-hearts" aria-hidden="true" id="bgHearts"></div>

  <main class="wrap" role="main">
    <section class="card" aria-label="Valentine question card" id="card">
      <div class="content">
        <h1>Will you be my Valentine? üíñ</h1>
        <p class="sub">I have a question for you‚Ä¶</p>

        <div class="buttons" aria-label="Answer buttons area" id="btnArea">
          <button id="yesBtn" type="button" aria-label="Yes">
            Yes üòç
            <span class="shine" aria-hidden="true"></span>
          </button>

          <button id="noBtn" type="button" aria-label="No (not clickable)">
            No üôÑ
          </button>
        </div>

        <div class="hint" id="hint" aria-live="polite">
          (Psst‚Ä¶ only one of these is brave enough to stay put.)
        </div>
      </div>
    </section>

    <footer aria-label="Footer">
      Made with love ‚ù§Ô∏è
    </footer>
  </main>

  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-label="Celebration">
    <div class="confetti" id="confetti" aria-hidden="true"></div>
    <div class="burst" id="burst" aria-hidden="true"></div>

    <div class="celebrate">
      <h2>YAY!! üíïüíç See you on Valentine's Day!</h2>
      <p class="mini">Screenshot this and send it to me üòò</p>
    </div>
  </div>

  <script>
    (() => {
      const card = document.getElementById('card');
      const btnArea = document.getElementById('btnArea');
      const yesBtn = document.getElementById('yesBtn');
      const noBtn  = document.getElementById('noBtn');
      const hint   = document.getElementById('hint');

      const overlay = document.getElementById('overlay');
      const confetti = document.getElementById('confetti');
      const burst = document.getElementById('burst');

      // --- Subtle floating hearts background ---
      const bg = document.getElementById('bgHearts');
      const makeBgHearts = (count = 18) => {
        bg.innerHTML = '';
        for (let i = 0; i < count; i++) {
          const h = document.createElement('div');
          h.className = 'h';
          const left = Math.random() * 100;
          const delay = Math.random() * 8;
          const dur = 10 + Math.random() * 14;
          const size = 0.7 + Math.random() * 1.4;

          h.style.left = left + 'vw';
          h.style.top = (80 + Math.random() * 30) + 'vh';
          h.style.animationDuration = dur + 's';
          h.style.animationDelay = (-delay) + 's';
          h.style.setProperty('--s', size.toFixed(2));
          h.style.opacity = (0.35 + Math.random() * 0.35).toFixed(2);
          bg.appendChild(h);
        }
      };
      makeBgHearts(window.matchMedia('(max-width: 420px)').matches ? 14 : 18);
      window.addEventListener('resize', () => {
        makeBgHearts(window.matchMedia('(max-width: 420px)').matches ? 14 : 18);
      }, { passive: true });

      // --- "No" button evasive behavior ---
      let attempts = 0;
      let lastMoveAt = 0;
      const MAX_ATTEMPTS = 5;

      // Place No in an initial safe spot
      const clamp = (v, min, max) => Math.min(max, Math.max(min, v));

      function randomizeNoPosition() {
        // ensure layout is measurable
        const areaRect = btnArea.getBoundingClientRect();
        const btnRect = noBtn.getBoundingClientRect();

        const padding = 10;
        const maxX = Math.max(padding, areaRect.width - btnRect.width - padding);
        const maxY = Math.max(padding, areaRect.height - btnRect.height - padding);

        const x = padding + Math.random() * (maxX - padding);
        const y = padding + Math.random() * (maxY - padding);

        // Position relative to btnArea
        noBtn.style.left = x + 'px';
        noBtn.style.top = y + 'px';
        noBtn.style.transform = 'none';
      }

      function hideNo() {
        noBtn.style.display = 'none';
        hint.textContent = "Okay okay, the 'No' button gave up üòÖ";
      }

      function moveNo(reason) {
        const now = performance.now();
        if (now - lastMoveAt < 160) return; // debounce jitter
        lastMoveAt = now;

        attempts++;
        if (attempts >= MAX_ATTEMPTS) {
          hideNo();
          return;
        }

        randomizeNoPosition();

        const remaining = MAX_ATTEMPTS - attempts;
        hint.textContent =
          remaining === 1
            ? "So close‚Ä¶ one more try üòè"
            : `Nice try üòõ (${remaining} tries left)`;
      }

      function distPointToRect(px, py, rect) {
        const dx = Math.max(rect.left - px, 0, px - rect.right);
        const dy = Math.max(rect.top - py, 0, py - rect.bottom);
        return Math.hypot(dx, dy);
      }

      function maybeEvadeFromPointer(clientX, clientY) {
        if (noBtn.style.display === 'none') return;
        const rect = noBtn.getBoundingClientRect();
        const d = distPointToRect(clientX, clientY, rect);
        // "Proximity" threshold
        const threshold = 70; // px
        if (d <= threshold) moveNo('proximity');
      }

      // Mouse move proximity
      card.addEventListener('mousemove', (e) => {
        maybeEvadeFromPointer(e.clientX, e.clientY);
      }, { passive: true });

      // Pointer move proximity (covers touch hover-ish + stylus)
      card.addEventListener('pointermove', (e) => {
        // Only if pointer is in contact or on devices that support hover
        if (e.pointerType === 'mouse' || e.pressure > 0) {
          maybeEvadeFromPointer(e.clientX, e.clientY);
        }
      }, { passive: true });

      // Touch/pointer: if tap near the No button, it moves away
      card.addEventListener('pointerdown', (e) => {
        if (noBtn.style.display === 'none') return;
        // Do not interfere with clicking Yes
        if (e.target === yesBtn) return;
        maybeEvadeFromPointer(e.clientX, e.clientY);
      }, { passive: true });

      // Also evade if finger lands in the buttons area (common on mobile)
      btnArea.addEventListener('touchstart', (e) => {
        if (noBtn.style.display === 'none') return;
        const t = e.touches && e.touches[0];
        if (!t) return;
        maybeEvadeFromPointer(t.clientX, t.clientY);
      }, { passive: true });

      // Initial random position after first paint to ensure accurate sizes
      requestAnimationFrame(() => randomizeNoPosition());

      // --- Celebration: confetti + heart burst + optional sound on YES click ---
      function rand(min, max){ return min + Math.random() * (max - min); }

      function makeConfettiPieces(n = 120) {
        confetti.innerHTML = '';
        const w = window.innerWidth;

        for (let i = 0; i < n; i++) {
          const p = document.createElement('i');

          // No fixed color scheme: random bright-ish HSL
          const hue = Math.floor(rand(0, 360));
          const sat = Math.floor(rand(70, 95));
          const light = Math.floor(rand(55, 72));
          p.style.background = `hsl(${hue} ${sat}% ${light}%)`;

          const x = Math.floor(rand(0, w));
          const drift = Math.floor(rand(-120, 120));
          const dur = rand(2.2, 4.6);
          const delay = rand(0, 0.8);
          const rot = `${Math.floor(rand(540, 1200))}deg`;
          const scale = rand(0.75, 1.4);

          p.style.left = x + 'px';
          p.style.top = '-12vh';
          p.style.transform = `translate3d(0,-12vh,0) rotate(0deg) scale(${scale})`;
          p.style.animationDuration = dur + 's';
          p.style.animationDelay = delay + 's';
          p.style.setProperty('--x', x + 'px');
          p.style.setProperty('--drift', drift + 'px');
          p.style.setProperty('--r', rot);

          confetti.appendChild(p);
        }

        // Clean up after animation
        setTimeout(() => { confetti.innerHTML = ''; }, 6000);
      }

      function makeHeartBurst(cx, cy, count = 26) {
        burst.innerHTML = '';
        const rect = overlay.getBoundingClientRect();
        const x0 = cx ?? rect.width / 2;
        const y0 = cy ?? rect.height / 2;

        for (let i = 0; i < count; i++) {
          const h = document.createElement('div');
          h.className = 'heart';
          const angle = rand(0, Math.PI * 2);
          const radius = rand(70, 240);
          const dx = Math.cos(angle) * radius;
          const dy = Math.sin(angle) * radius;

          h.style.left = (x0 - 7) + 'px';
          h.style.top = (y0 - 7) + 'px';
          h.style.setProperty('--dx', dx.toFixed(1) + 'px');
          h.style.setProperty('--dy', dy.toFixed(1) + 'px');
          h.style.animationDelay = rand(0, 0.12) + 's';

          burst.appendChild(h);
        }

        setTimeout(() => { burst.innerHTML = ''; }, 1200);
      }

      // Optional click-sound (generated, no external asset)
      async function playTinyCelebrationSound() {
        try {
          const AudioCtx = window.AudioContext || window.webkitAudioContext;
          if (!AudioCtx) return;
          const ctx = new AudioCtx();
          // Must resume on user gesture; if blocked, this will throw or remain suspended
          await ctx.resume();

          const now = ctx.currentTime;

          const master = ctx.createGain();
          master.gain.setValueAtTime(0.0001, now);
          master.gain.exponentialRampToValueAtTime(0.25, now + 0.02);
          master.gain.exponentialRampToValueAtTime(0.0001, now + 0.75);
          master.connect(ctx.destination);

          // A short "sparkle" chord
          const freqs = [523.25, 659.25, 783.99]; // C5 E5 G5
          freqs.forEach((f, idx) => {
            const o = ctx.createOscillator();
            const g = ctx.createGain();
            o.type = 'sine';
            o.frequency.setValueAtTime(f, now);
            o.frequency.exponentialRampToValueAtTime(f * 2, now + 0.18);

            g.gain.setValueAtTime(0.0001, now);
            g.gain.exponentialRampToValueAtTime(0.22, now + 0.02);
            g.gain.exponentialRampToValueAtTime(0.0001, now + (0.28 + idx * 0.06));

            o.connect(g);
            g.connect(master);

            o.start(now + idx * 0.02);
            o.stop(now + 0.45 + idx * 0.06);
          });

          // Close after short time to free resources
          setTimeout(() => ctx.close().catch(() => {}), 1100);
        } catch (_) {
          // If blocked by browser policy, do nothing.
        }
      }

      function showCelebration(e) {
        overlay.classList.add('show');

        // Confetti quantity adapts to device
        const pieces = window.matchMedia('(max-width: 420px)').matches ? 100 : 150;
        makeConfettiPieces(pieces);

        // Heart burst at click location (or center)
        let cx = null, cy = null;
        if (e && typeof e.clientX === 'number') {
          cx = e.clientX;
          cy = e.clientY;
        }
        makeHeartBurst(cx, cy, 30);

        // Additional bursts
        setTimeout(() => makeHeartBurst(null, null, 26), 250);
        setTimeout(() => makeHeartBurst(null, null, 26), 520);

        // Optional sound (only on click)
        playTinyCelebrationSound();

        // Accessibility: move focus to overlay headline
        // (Create a temporary focus target)
        const h2 = overlay.querySelector('h2');
        h2.setAttribute('tabindex', '-1');
        h2.focus({ preventScroll: true });

        // Prevent scrolling behind overlay on some mobile browsers
        document.body.style.overflow = 'hidden';
      }

      yesBtn.addEventListener('click', showCelebration);

      // Allow closing overlay via Escape (nice for desktop)
      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && overlay.classList.contains('show')) {
          overlay.classList.remove('show');
          document.body.style.overflow = '';
          // reset celebration layers
          confetti.innerHTML = '';
          burst.innerHTML = '';
          // restore focus to yes button
          yesBtn.focus();
        }
      });

      // Keep "No" inside bounds if device rotates
      window.addEventListener('resize', () => {
        if (noBtn.style.display === 'none') return;
        // Re-clamp current position if needed
        const areaRect = btnArea.getBoundingClientRect();
        const btnRect = noBtn.getBoundingClientRect();

        // current relative position
        const left = parseFloat(noBtn.style.left || '0');
        const top = parseFloat(noBtn.style.top || '0');

        const padding = 10;
        const maxX = Math.max(padding, areaRect.width - btnRect.width - padding);
        const maxY = Math.max(padding, areaRect.height - btnRect.height - padding);

        noBtn.style.left = clamp(left, padding, maxX) + 'px';
        noBtn.style.top = clamp(top, padding, maxY) + 'px';
        noBtn.style.transform = 'none';
      }, { passive: true });

      // If user tries to select text/drag, keep it smooth
      document.addEventListener('dragstart', (e) => e.preventDefault());
    })();
  </script>
</body>
</html>